#key=query
# AdminDAO Query Properties

# ==================== \uB9E4\uC7A5 \uAD00\uB9AC \uCFFC\uB9AC ====================

# \uB9E4\uC7A5 \uAE30\uBCF8 CRUD
store.insert=INSERT INTO Store (owner_id, store_name, address, region, phone_number, description, img_src) VALUES (?, ?, ?, ?, ?, ?, ?)
store.update=UPDATE Store SET store_name = ?, address = ?, region = ?, phone_number = ?, description = ?, img_src = ? WHERE store_id = ?
store.delete=DELETE FROM Store WHERE store_id = ?
store.selectById=SELECT * FROM Store WHERE store_id = ?
store.selectAll=SELECT * FROM Store ORDER BY created_at DESC
store.selectByOwnerId=SELECT * FROM Store WHERE owner_id = ?

# ==================== \uBA54\uB274 \uAD00\uB9AC \uCFFC\uB9AC ====================

# \uBA54\uB274 \uAE30\uBCF8 CRUD
menu.insert=INSERT INTO Menu (store_id, menu_name, price, description, img_src, category1_code, category2_code, check_rec, order_request, sold_out) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
menu.update=UPDATE Menu SET menu_name = ?, price = ?, description = ?, img_src = ?, category1_code = ?, category2_code = ?, check_rec = ?, order_request = ?, sold_out = ? WHERE menu_id = ?
menu.delete=DELETE FROM Menu WHERE menu_id = ?
menu.selectById=SELECT * FROM Menu WHERE menu_id = ?
menu.selectByStoreId=SELECT * FROM Menu WHERE store_id = ? ORDER BY menu_id
menu.checkActiveOrders=SELECT COUNT(*) FROM OrderDetail od JOIN OrderTable ot ON od.order_id = ot.order_id WHERE od.menu_id = ? AND ot.status = 'pending'

# ==================== \uC720\uC800 \uAD00\uB9AC \uCFFC\uB9AC ====================

user.delete=DELETE FROM User WHERE user_id = ?
user.selectById=SELECT * FROM User WHERE user_id = ?
user.selectAll=SELECT * FROM User ORDER BY created_at DESC

# ==================== \uC8FC\uBB38/\uB9E4\uCD9C \uAD00\uB9AC \uCFFC\uB9AC ====================

order.countPending=SELECT COUNT(*) FROM OrderTable WHERE store_id = ? AND status = 'pending'
order.countByPeriod=SELECT COUNT(*) FROM OrderTable WHERE store_id = ? AND DATE(order_date) BETWEEN ? AND ?
sales.sumByPeriod=SELECT IFNULL(SUM(total_price), 0) FROM OrderTable WHERE store_id = ? AND DATE(order_date) BETWEEN ? AND ? AND status = 'completed'
sales.dailySales=SELECT DATE(order_date) as sale_date, SUM(total_price) as daily_total FROM OrderTable WHERE store_id = ? AND DATE(order_date) BETWEEN ? AND ? AND status = 'completed' GROUP BY DATE(order_date) ORDER BY sale_date
sales.menuSales=SELECT m.menu_name, SUM(od.quantity) as total_quantity, SUM(od.price) as total_sales FROM OrderDetail od JOIN Menu m ON od.menu_id = m.menu_id JOIN OrderTable ot ON od.order_id = ot.order_id WHERE m.store_id = ? AND DATE(ot.order_date) BETWEEN ? AND ? AND ot.status = 'completed' GROUP BY m.menu_id, m.menu_name ORDER BY total_sales DESC

# ==================== \uD14C\uC774\uBE14/QR \uAD00\uB9AC \uCFFC\uB9AC ====================

table.selectStoreTables=SELECT st.table_id, st.table_no, st.store_id, s.store_name, q.qrcode_data, q.qr_img_src, q.created_at FROM StoreTable st JOIN Store s ON st.store_id = s.store_id LEFT JOIN QRCode q ON st.table_id = q.table_id WHERE st.store_id = ? ORDER BY st.table_id
table.upsertQR=INSERT INTO QRCode (table_id, qrcode_data, qr_img_src) VALUES (?, ?, ?) ON DUPLICATE KEY UPDATE qrcode_data = VALUES(qrcode_data), qr_img_src = VALUES(qr_img_src), created_at = CURRENT_TIMESTAMP
table.selectById=SELECT st.table_id, st.table_no, st.store_id, s.store_name FROM StoreTable st JOIN Store s ON st.store_id = s.store_id WHERE st.table_id = ?
table.selectQRByTableId=SELECT q.*, st.table_no, s.store_name, s.store_id FROM QRCode q JOIN StoreTable st ON q.table_id = st.table_id JOIN Store s ON st.store_id = s.store_id WHERE q.table_id = ?