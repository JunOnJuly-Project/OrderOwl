#key=query

## user query
# CusQuery
query.order.selectBystoreId=select * from store where store_id = (select store_id from storetable where table_id =?)
query.order.selectMenuBystoreId=select * from menu where menu_id = ?
query.order.selectAllMenuBystoreId=select * from menu where store_id = (select store_id from storetable where table_id =?)
query.order.insertOrderDetail=insert into orderdetail value (null,?,?,?,?);
query.order.canOrderCheck=select table_status from ordertable where table_id=? order by order_id desc limit 1;
query.order.findLastOrderId=select order_id from ordertable where table_id = ? order by order_id desc limit 1;
query.order.insertNewOrder=insert into ordertable values (null,?,?,now(),'pending',0,0,'Y')
query.order.findOrderTotalPrice=select total_price from ordertable where order_id =?;
query.order.updateOrderTotalPrice=update ordertable set total_price = ? where order_id =?; 
query.order.selectMenuListByCategoryId =select has_menu_id from category where category_id = ?;
query.order.selectOrderAllOrderByOrderId=select m.menu_name,m.price,o.quantity from orderdetail o,menu m where m.menu_id = o.menu_id and order_id = ?;
# menu
user.menu.insert=INSERT INTO Menu (store_id, menu_name, price, description, img_src, category1_code, category2_code, check_rec, order_request, close_time, sold_out) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
user.menu.delete=DELETE FROM Menu WHERE menu_id=?
user.menu.update=UPDATE Menu SET menu_name=?, price=?, description=?, img_src=?, category1_code=?, category2_code=?, check_rec=?, order_request=?, close_time=?, sold_out=? WHERE store_id=? and menu_id=?
user.menu.selectById=SELECT * FROM Menu WHERE menu_id=?;
user.menu.selectAll=SELECT menu_id, store_id, menu_name, price, m.description, m.img_src, category1_code, category2_code, check_rec, order_request, close_time, sold_out FROM Menu as m JOIN Store as s using(store_id) WHERE owner_id=?;

# order
user.order.selectAll=SELECT order_id, store_id, table_id, order_date, status, total_price, min_price, table_status, order_detail_id, menu_id, quantity, price FROM OrderTable JOIN OrderDetail USING(order_id) Join Store USING(store_id) WHERE owner_id=? and status="pending" ORDER BY order_date;
user.order.selectByState=SELECT * FROM OrderTable JOIN OrderDetail USING(order_id) Join Store USING(store_id) WHERE owner_id=? and state=?;
user.order.update=UPDATE OrderTable SET status=? WHERE order_id=?;

# store
user.store.join=INSERT INTO Store (owner_id, store_name, address, region, phone_number, description, img_src, created_at) VALUES (?, ?, ?, ?, ?, ?, ?, now());
user.store.quit=DELETE FROM User WHERE user_id=?;
user.store.update=UPDATE Store SET store_name=?, address=?, region=?, phone_number=?, description=?, img_src=? WHERE store_id=?
user.store.select=SELECT * from Store where owner_id=?;

# sales
user.sales.select.year=SELECT YEAR(order_date) AS year, sum(total_price) as total from OrderTable join Store using(store_id) where owner_id=? and status='completed' group by YEAR(order_date) order by year;
user.sales.select.month=SELECT MONTH(order_date) AS month, sum(total_price) as total from OrderTable join Store using(store_id) where owner_id=? and status='completed' and YEAR(order_date)=YEAR(now()) group by MONTH(order_date) order by month;
user.sales.select.week=SELECT WEEK(order_date) AS week, sum(total_price) as total from OrderTable join Store using(store_id) where owner_id=? and status='completed' and YEAR(order_date)=YEAR(now()) and MONTH(order_date)=MONTH(now()) group by WEEK(order_date) order by week;
user.sales.select.day=SELECT DAY(order_date) AS day, sum(total_price) as total from OrderTable join Store using(store_id) where owner_id=? and status='completed' and YEAR(order_date)=YEAR(now()) and MONTH(order_date)=MONTH(now()) and WEEK(order_date)=WEEK(now()) group by DAY(order_date) order by day;
user.sales.select.hour=SELECT HOUR(order_date) AS hour, sum(total_price) as total from OrderTable join Store using(store_id) where owner_id=? and status='completed' and YEAR(order_date)=YEAR(now()) and MONTH(order_date)=MONTH(now()) and WEEK(order_date)=WEEK (now()) and DAY(order_date)=DAY(now()) group by HOUR(order_date) order by hour;
user.sales.select.menu=SELECT menu_name AS menu, SUM(m.price) AS total FROM OrderTable JOIN OrderDetail USING(order_id) JOIN Menu AS m USING(menu_id) WHERE status='completed' GROUP BY menu_id order by menu_id;

# auth
user.auth=SELECT * FROM Store WHERE owner_id=?;
user.auth.account=INSERT INTO User (username, password, email, created_at) values (?, ?, ?, now());
user.auth.login=SELECT * FROM User WHERE email=? and password=?;

# table
user.table.create=INSERT INTO StoreTable (store_id, table_no) values (?, ?);
user.table.count=Select Count(*) From StoreTable where store_id=?;
user.table.select=Select * From StoreTable Where store_id=?;

# qr
user.qr.create=INSERT INTO QRCode (table_id, qrcode_data, qr_img_src) values (?, ?, ?);

# AdminDAO Query Properties

# ==================== \uB9E4\uC7A5 \uAD00\uB9AC \uCFFC\uB9AC ====================

# \uB9E4\uC7A5 \uAE30\uBCF8 CRUD
store.insert=INSERT INTO Store (owner_id, store_name, address, region, phone_number, description, img_src) VALUES (?, ?, ?, ?, ?, ?, ?)
store.update=UPDATE Store SET store_name = ?, address = ?, region = ?, phone_number = ?, description = ?, img_src = ? WHERE store_id = ?
store.delete=DELETE FROM Store WHERE store_id = ?
store.selectById=SELECT * FROM Store WHERE store_id = ?
store.selectAll=SELECT * FROM Store ORDER BY created_at DESC
store.selectByOwnerId=SELECT * FROM Store WHERE owner_id = ?

# ==================== \uBA54\uB274 \uAD00\uB9AC \uCFFC\uB9AC ====================

# \uBA54\uB274 \uAE30\uBCF8 CRUD
menu.insert=INSERT INTO Menu (store_id, menu_name, price, description, img_src, category1_code, category2_code, check_rec, order_request, sold_out) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
menu.update=UPDATE Menu SET menu_name = ?, price = ?, description = ?, img_src = ?, category1_code = ?, category2_code = ?, check_rec = ?, order_request = ?, sold_out = ? WHERE menu_id = ?
menu.delete=DELETE FROM Menu WHERE menu_id = ?
menu.selectById=SELECT * FROM Menu WHERE menu_id = ?
menu.selectByStoreId=SELECT * FROM Menu WHERE store_id = ? ORDER BY menu_id
menu.checkActiveOrders=SELECT COUNT(*) FROM OrderDetail od JOIN OrderTable ot ON od.order_id = ot.order_id WHERE od.menu_id = ? AND ot.status = 'pending'

# ==================== \uC720\uC800 \uAD00\uB9AC \uCFFC\uB9AC ====================

user.delete=DELETE FROM User WHERE user_id = ?
user.selectById=SELECT * FROM User WHERE user_id = ?
user.selectAll=SELECT * FROM User ORDER BY created_at DESC

# ==================== \uC8FC\uBB38/\uB9E4\uCD9C \uAD00\uB9AC \uCFFC\uB9AC ====================

order.countPending=SELECT COUNT(*) FROM OrderTable WHERE store_id = ? AND status = 'pending'
order.countByPeriod=SELECT COUNT(*) FROM OrderTable WHERE store_id = ? AND DATE(order_date) BETWEEN ? AND ?
sales.sumByPeriod=SELECT IFNULL(SUM(total_price), 0) FROM OrderTable WHERE store_id = ? AND DATE(order_date) BETWEEN ? AND ? AND status = 'completed'
sales.dailySales=SELECT DATE(order_date) as sale_date, SUM(total_price) as daily_total FROM OrderTable WHERE store_id = ? AND DATE(order_date) BETWEEN ? AND ? AND status = 'completed' GROUP BY DATE(order_date) ORDER BY sale_date
sales.menuSales=SELECT m.menu_name, SUM(od.quantity) as total_quantity, SUM(od.price) as total_sales FROM OrderDetail od JOIN Menu m ON od.menu_id = m.menu_id JOIN OrderTable ot ON od.order_id = ot.order_id WHERE m.store_id = ? AND DATE(ot.order_date) BETWEEN ? AND ? AND ot.status = 'completed' GROUP BY m.menu_id, m.menu_name ORDER BY total_sales DESC

# ==================== \uD14C\uC774\uBE14/QR \uAD00\uB9AC \uCFFC\uB9AC ====================

table.selectStoreTables=SELECT st.table_id, st.table_no, st.store_id, s.store_name, q.qrcode_data, q.qr_img_src, q.created_at FROM StoreTable st JOIN Store s ON st.store_id = s.store_id LEFT JOIN QRCode q ON st.table_id = q.table_id WHERE st.store_id = ? ORDER BY st.table_id
table.upsertQR=INSERT INTO QRCode (table_id, qrcode_data, qr_img_src) VALUES (?, ?, ?) ON DUPLICATE KEY UPDATE qrcode_data = VALUES(qrcode_data), qr_img_src = VALUES(qr_img_src), created_at = CURRENT_TIMESTAMP
table.selectById=SELECT st.table_id, st.table_no, st.store_id, s.store_name FROM StoreTable st JOIN Store s ON st.store_id = s.store_id WHERE st.table_id = ?
table.selectQRByTableId=SELECT q.*, st.table_no, s.store_name, s.store_id FROM QRCode q JOIN StoreTable st ON q.table_id = st.table_id JOIN Store s ON st.store_id = s.store_id WHERE q.table_id = ?
# \uACB0\uC81C \uAD00\uB9AC
payment.selectAll=SELECT * FROM Payment ORDER BY payment_date DESC
payment.selectById=SELECT * FROM Payment WHERE payment_id = ?
payment.updateStatus=UPDATE Payment SET payment_status = ? WHERE payment_id = ?
